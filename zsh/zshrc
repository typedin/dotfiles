#!/usr/bin/env zsh
# +------------+
# | Color theme|
# +------------+
# define the color palette right away so that it can be used in the rest of the file
source ~/.config/zsh/themes/tokyo-night.zsh

# +------------+
# | COMPLETION |
# +------------+
autoload -U compinit; compinit

# Add deno completions to search path
if [[ ":$FPATH:" != *":/home/antoine/.zsh/completions:"* ]]; then 
    export FPATH="/home/antoine/.zsh/completions:$FPATH"; 
fi

source ~/.config/zsh/zsh-aliases
source ~/.config/zsh/zsh-exports
export COLORTERM=truecolor
export LC_ALL=en_US.UTF-8

# +------------+
# | NAVIGATION |
# +------------+
setopt AUTO_CD                            # Go to folder path without using cd.
setopt AUTO_PUSHD                         # Push the old directory onto the stack on cd.
setopt PUSHD_IGNORE_DUPS                  # Do not store duplicates in the stack.
setopt PUSHD_SILENT                       # Do not print the directory stack after pushd or popd.
setopt CORRECT                            # Spelling correction
setopt CDABLE_VARS                        # Change directory to a path stored in a variable.
setopt EXTENDED_GLOB                      # Use extended globbing syntax.

source ~/dotfiles/zsh/plugins/bd.zsh

# +---------+
# | HISTORY |
# +---------+
setopt EXTENDED_HISTORY                   # Write the history file in the ':start:elapsed;command' format.
setopt SHARE_HISTORY                      # Share history between all sessions.
setopt HIST_EXPIRE_DUPS_FIRST             # Expire a duplicate event first when trimming history.
setopt HIST_IGNORE_DUPS                   # Do not record an event that was just recorded again.
setopt HIST_IGNORE_ALL_DUPS               # Delete an old recorded event if a new event is a duplicate.
setopt HIST_FIND_NO_DUPS                  # Do not display a previously found event.
setopt HIST_IGNORE_SPACE                  # Do not record an event starting with a space.
setopt HIST_SAVE_NO_DUPS                  # Do not write a duplicate event to the history file.
setopt HIST_VERIFY                        # Do not execute immediately upon history expansion.

bindkey '\e[A' history-search-backward    # autocompletion using down arrow key (based on history)
bindkey '\e[B' history-search-forward     # autocompletion using up arrow key (based on history)

HISTFILE=$HOME/.zhistory                  # Set the history file.
SAVEHIST=1000                             # Set the number of history entries to save.
HISTSIZE=999                              # Set the number of history entries to save.

# +--------+
# | PROMPT |
# +--------+
fpath=(~/.config/zsh/ $fpath)       # add current directory to path
autoload -Uz prompt_purification_setup && prompt_purification_setup

# +---------------------+
# | SYNTAX HIGHLIGHTING |
# +---------------------+
# must be at the end of the file
source /usr/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
source ~/.config/zsh/themes/theme.zsh
